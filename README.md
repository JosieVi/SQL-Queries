# SQL-Queries
## Homework-1
<b>Результат выполнения задания:</b>\
[Homework-1](https://github.com/JosieVi/SQL-Queries/blob/main/Homework-1.pdf)
или [Google Диск](https://docs.google.com/spreadsheets/d/1vVjrZCGVofFnBnsH-Ch3aMf7fGyOcTCEuH6yH3VVYHQ/edit#gid=0)

Напишите SQL запросы.
1. Выведите имя, фамилию, патронуса всех персонажей, у которых есть patronus или он известен.
2. Выведите фамилию персонажей, у которых последняя буква в фамилии ‘e’.
3. Посчитайте общий возраст всех персонажей и выведите это на экран.
4. Выведите имя, фамилию и возраст персонажей по убыванию их возраста.
5. Выведите имя персонажа и возраст, у которых последний находится в диапазоне от 50 до 100 лет.
6. Выведите возраст всех персонажей так, чтобы среди них не было тех, у кого он одинаковый.
7. Выведите всю информацию о персонажах, у которых faculty = Gryffindor и чей возраст больше 30 лет.
8. Выведите имена первых трех факультетов из таблицы, так чтобы факультеты не повторялись.
9. Выведите имена всех персонажей, у которых имя начинается с ‘H’ и состоит из 5 букв, или чье имя начинается с ‘L’.
10. Посчитайте средний возраст всех персонажей.
11. Удалите персонажа с ID = 11.
12. Выведите фамилию всех персонажей, которые содержат в ней букву ‘a’.
13. Используйте псевдоним для того, чтобы временно замените название столбца fname на Half-Blood Prince для реального принца-полукровки.
14. Выведите id и имена всех патронусов в алфавитном порядки, при условии что они есть или известны.
15. Используя оператор IN, выведите имя и фамилию тех персонажей, у которых фамилия Crabbe, Granger или Diggory.
16. Выведите минимальный возраст персонажа.
17. Используя оператор UNION выберите имена из таблицы characters и названия книг из таблицы library.
18. Используя оператор HAVING посчитайте количество персонажей на каждом факультете, оставив только те факультеты, где количество студентов больше 1.
19. Используя оператор CASE опишите следующую логику:\
Выведите имя и фамилию персонажа, а также следующий текстовое сообщение:
- Если факультет Gryffindor, то в консоли должно вывестись Godric.
- Если факультет Slytherin, то в консоли должно вывестись Salazar.
- Если факультет Ravenclaw, то в консоли должно вывестись Rowena.
- Если факультет Hufflepuff, то в консоли должно вывестись Helga.
- Если другая информация, то выводится Muggle\
Для сообщения используйте псевдоним Founders.
20. Используя регулярное выражение найдите фамилии персонажей, которые не начинаются с букв H, L или S и выведите их.


## Homework-2
<b>Результат выполнения задания:</b>\
[Homework-2](https://github.com/JosieVi/SQL-Queries/blob/main/Homework-2.pdf)
или [Google Диск](https://docs.google.com/spreadsheets/d/1vVjrZCGVofFnBnsH-Ch3aMf7fGyOcTCEuH6yH3VVYHQ/edit#gid=1451069378)

Напишите SQL запросы.
1. Выведите имя, фамилию персонажей и название книги, которая на них числится.
2. Выведите имя, фамилию персонажей и название книги, вне зависимости от того, есть ли у них книги или нет.
3. Выведите название книги и имя патронуса, вне зависимости от того, есть ли информация о держателе книги в таблице или нет.
4. Выведите имя, фамилию, возраст персонажей и название книги, которая на них числится, при условии, что все владельцы книг должны быть старше 15 лет.
5. Выведите имя персонажа, название книги, дату выдачи и дату завершения, при условии, что он младше 15 лет и его патронус неизвестен.
6. Используя вложенный запрос количество книг, у которых end_date больше, чем end_date у Hermione.
7. С помощью вложенного запроса выведите имена всех патронусов, у которых владельцы старше возраста персонажа, у которого патронус Unknown.


## Homework-3
<b>Результат выполнения задания:</b>\
[Homework-3](https://github.com/JosieVi/SQL-Queries/blob/main/Homework-3.pdf)
или [Google Диск](https://docs.google.com/spreadsheets/d/1-bhjlo1zv7hOhCTfojRU2rXvUY7tOQB-sksoBWhG7os/edit#gid=777468835)

В БД есть 3 сущности: FIO_person, Salary и JobPosition. 		
1. Таблица FIO_person содержит атрибуты:
- ID (id сотрудника), 
- FIO (ФИО сотрудника)
2. Таблица Salary содержит атрибуты:	
- Salary_ID (id записи по ЗП)
- Person_ID (внешний ключ к таблице FIO_person)
- Value (ЗП сотрудника)
3. Таблица JobPosition содержит атрибуты:
- Position_ID (id записи по должности)
- Person_ID (внешний ключ к таблице FIO_person)
- NamePosition (название должности)
- Duration (кол-во лет в должности)\

Напишите SQL запросы.
1. Получить список всех сотрудников с именем с ФИО - Петров Максим Егорович.
2. Получить список всех сотрудников по имени Иван.
3. Получить список всех ФИО сотрудников по должности «Разработчик» с зарплатой, большей 10 000 рублей.
4. Получить отсортированный в алфавитном порядке список всех существующих должностей в компании.
5. Вывести список, содержащий ФИО, ЗП, должность и кол-во лет в должности для сотрудников, которые проработали от 1 до 10 лет.